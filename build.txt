Building Orange C

These instructions are for building on WIN32.  I actually build on WINDOWS 7.

you will also need 7-zip, UPX, inno setup, and either BORLAND C++ 5.5 or Visual Studio 2010 to do a complete build.

First, the distribution directories are meant to go in a subdirectory.  I name mine OrangeC and put it in the root, then put the SRC and DOC directories in there.  Later, the build steps may create other directories such as a BIN directory and an INCLUDE directory.  So for example:

C:\ORANGEC\SRC  is where all my files go.  IF you want to change it go into src/makefile and change the definition of DISTROOT.

You can change the version number by editing SRC\VERSION.H then rebuilding everything.

Building orange C happens in three steps.  First, the executables are built.  Then, the C Runtime library is built.  After that, the distribution release files are built.

To build the executables you can either install borland C++ 5.5, the free version, or you you can install Visual Studio Express.  The build files for Visual Studio Express assume VC2010, I don't know if they will port forward.

To build the executables with borland C++ 5.5, you switch to the SRC directory, then type omake.  It will build the executables and leave them in their source directories.  A later step will be required to move them to a location suitable for building the C Runtime Library.

To build the executables with Visual Studio 2010, you can either do it from the IDE, or run VCVARS32.bat {from the MS distribution} followed by switching to the SRC directory and running MS.BAT.

Once the executables are built, you have to move them to the BIN directory.  This is the point at which you need UPX.  {you can modify the DIST.MAK file to not require the UPX step if you want.} To do this run omake as follows:

omake -DBUILDENV DISTRIBUTE

Or if you want to use the executables generated by visual studio:

omake -DBUILDENV -DMS DISTRIBUTE

That will create some directories at the same level as the SRC directory and put files you need there.  

Once the files are there, create an environment variable ORANGEC.  If you used my directories you would say:

set ORANGEC=C:\OrangeC

at the DOS command prompt.

Add the bin directory to the path, again with my directories you would say:

PATH=C:\ORANGEC\BIN;%PATH%

At this point you are ready to build the run time libraries.

To do this, switch to SRC/CLIBS and type 'omake'.

Note: some antivirus checkers may not like the file 'LSCRTL.DLL' which gets generated.  This is the C Runtime library in DLL format.  While you can live without it it is still part of the build.


After a while the run time library will be built and you can make the distribution.  This is the point at which you need 7-zip and inno setup.

type:

omake DISTRIBUTE

or to use the visual studio version of the executables:

omake -DMS DISTRIBUTE

At this point it will move everything required for a release into directories at the same level as the SRC directory, then zip it and make an install package in the DIST directory at the same level as the SRC directory.

